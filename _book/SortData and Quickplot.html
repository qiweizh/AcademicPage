
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>SortData and Quickplot Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Personal.html" />
    
    
    <link rel="prev" href="Zircon REE reverse model.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Research.html">
            
                <a href="Research.html">
            
                    
                    Research
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="3D Ternary phase diagram.html">
            
                <a href="3D Ternary phase diagram.html">
            
                    
                    3D Ternary phase diagram
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="Principles.html">
            
                <a href="Principles.html">
            
                    
                    Principles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="Ternary Eutectic System No Solid Solubility.html">
            
                <a href="Ternary Eutectic System No Solid Solubility.html">
            
                    
                    Ternary Eutectic System (No Solid Solubility)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="Ternary Eutectic System Solid Solubility.html">
            
                <a href="Ternary Eutectic System Solid Solubility.html">
            
                    
                    Ternary Eutectic System (No Solid Solubility)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.4" data-path="An-Or-Ab system.html">
            
                <a href="An-Or-Ab system.html">
            
                    
                    An-Or-Ab system
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="High silica granite.html">
            
                <a href="High silica granite.html">
            
                    
                    Fractionation of high silica granite
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="My program.html">
            
                <a href="My program.html">
            
                    
                    My program
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="Zircon REE reverse model.html">
            
                <a href="Zircon REE reverse model.html">
            
                    
                    Zircon REE reverse model
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.2" data-path="SortData and Quickplot.html">
            
                <a href="SortData and Quickplot.html">
            
                    
                    SortData and Quickplot
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="Personal.html">
            
                <a href="Personal.html">
            
                    
                    Personal
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >SortData and Quickplot</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="sortdata-and-quickplot">SortData and Quickplot</h1>
<p>Geochemical researches often require great amount work of comparing data to those in literature. It is necessary and significant to find a quick way to create figures to show their geochemical variation. Because most scholars use Microsoft Excel&#xAE; to process data, I design a VB program which incorporates the most common geochemical discrimination figures, trace element spider diagrams, Haker diagrams and etc. While a great deal of software could do this job, my program has two unique advantages: (1) Quickly sort element sequence (2) Automatically Group data. These two functions could significantly increase work efficiency.</p>
<p>The next part will show how to run this program.
Let&#x2019;s roll</p>
<h2 id="sort-data">Sort data</h2>
<p>The sequence of the major and trace elements listed in tables is different from author to author, which cause much inconvenience when comparing data to literature. The smart VB program (SortData.xlam) is designed to solve this problem. For example, If we have two columns of sample data like CB15-1 and CB15-2 (Fig. 1), And we want the elements to be set as SiO2, TiO2, Al2O3, Fe2O3, FeO, MnO, MgO, CaO, Na2O, K2O, P2O5, Fe2O3T, FeOT, Li, Be, Sc, Ti, V, Cr, Mn, Co, Ni, Cu, Zn, Ga, Ge, As, F, B, Sn, Cs, Rb, Mo, Cd, Sr, Zr, Nb, Sb, Ba, W, Tl, Hf, Ta, Pb, Bi, Th, U, Y, La, Ce, Pr, Nd, Sm, Eu, Gd, Tb, Dy, Ho, Er, Tm, Yb, Lu, LOI. </p>
<p><img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_1.jpg?raw=true" width="400" height="1000"></p>
<p>Fig. 1 The results of sorting</p>
<p>The first step open a new workbook and put the data needed to be sorted in &#x2018;Sheet1&#x2019; (Please note the first column is the name of elements). Next, press &#x201C;Alt+F11&#x201D; to open VBAproject, select DataSort and press &#x201C;Run&#x201D; (Fig. 2a), and a window will come up as shown in Fig. 2b. Press &#x2018;Check element&#x2019; button. </p>
<p><img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_2.jpg?raw=true" width="300" height="250"></p>
<p>Fig. 2 (a) How to run SortData program (b) The interface of SortData</p>
<p>Then, it will check the element name column A in the &#x2018;Sheet1&#x2019;. If there is something wrong, for example, if &#x2018;Al2O3&#x2019; was mistakenly written as &#x2018;AL2O3&#x2019;, it will be highlighted with yellow shade (Fig. 3). You should correct it and run the program again. Please note that &#x2018;Al2O3&#x2019; does not need to be written as &#x2018;Al2O3&#x2019;. </p>
<p><img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_3.jpg?raw=true" width="300" height="300"></p>
<p>Fig. 3 Highlighting incorrect elements</p>
<p>After making sure the name of elements is all correct, click &#x2018;SortData&#x2019; button. The data will be sorted as we want (Fig. 1). You can see that the sequence of CaO and MgO has been changed and there are some elements like Ge, and As is blank because the original data do not have them.</p>
<h2 id="group-data-and-plot">Group data and plot</h2>
<p>Copy the sort data into a new workbook and Open the &#x2018;Quickplot.xlam&#x2019;. The table cell A1, B1, C1, D1 is &#x2018;Group name&#x2019;, &#x2018;Longitude and latitude&#x2019;, &#x2018;Age (Ma)&#x2019;, and &#x2018;Rock type&#x2019;, respectively. If you do not know the latter three, just leave them blank, but you need to know names for each group. For example, I divide the data into four groups: &#x2018;OB&#x2019;, &#x2018;GB&#x2019;, &#x2018;HG&#x2019;, and &#x2018;GT&#x2019; by rock type. You just type the group name in the first column of your data (Fig. 4). </p>
<p><img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_4.jpg?raw=true" width="700" height="700"></p>
<p>Fig. 4 The result of grouping data</p>
<p>Press &#x201C;Alt+F11&#x201D; to open VBAproject and select &#x2018;Quickplot&#x2019; and run. a window will come up as shown in Fig. 5. Click &#x2018;Group&#x2019;. The data will be grouped quickly (Fig. 4). And then click &#x2018;Fe-calibration&#x2019; calibrate Fe2O3 and FeO into FeOT. </p>
<p><img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_5.jpg?raw=true" width="700" height="230"></p>
<p>Fig. 5 The interface of SortData of Quickplot</p>
<p>And then, you could click all other buttons to get other plots like TAS, A-type granite discrimination, Haker diagram, S-type granite source region discrimination, zircon saturation thermometer (ZTS), and trace element spider diagram and ect (Fig. 6). </p>
<p><img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_6a.jpg?raw=true" width="700" height="600">
<img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_6b.jpg?raw=true" width="700" height="600">
<img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_6c.jpg?raw=true" width="700" height="600"></p>
<p>Fig. 6 Representative figures made by Quickplot</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Zircon REE reverse model.html" class="navigation navigation-prev " aria-label="Previous page: Zircon REE reverse model">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Personal.html" class="navigation navigation-next " aria-label="Next page: Personal">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"SortData and Quickplot","level":"1.3.2","depth":2,"next":{"title":"Personal","level":"1.4","depth":1,"path":"Personal.md","ref":"Personal.md","articles":[]},"previous":{"title":"Zircon REE reverse model","level":"1.3.1","depth":2,"path":"Zircon REE reverse model.md","ref":"Zircon REE reverse model.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"SortData and Quickplot.md","mtime":"2019-03-28T01:07:27.679Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-03-28T13:31:08.810Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

