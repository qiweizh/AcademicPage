
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>2.3.2 SortData and Quickplot Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-theme-comscore/test.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Personal.html" />
    
    
    <link rel="prev" href="Zircon REE reverse model.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    1 Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Research.html">
            
                <a href="Research.html">
            
                    
                    2 Research
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="High silica granite.html">
            
                <a href="High silica granite.html">
            
                    
                    2.1 Fractionation of high silica granite
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="3D Ternary phase diagram.html">
            
                <a href="3D Ternary phase diagram.html">
            
                    
                    2.2 Ternary phase 3D model
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="Principles.html">
            
                <a href="Principles.html">
            
                    
                    2.2.1 Principles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="Ternary Eutectic System No Solid Solubility.html">
            
                <a href="Ternary Eutectic System No Solid Solubility.html">
            
                    
                    2.2.2 Ternary Eutectic System (No Solid Solubility)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="Ternary Eutectic System Solid Solubility.html">
            
                <a href="Ternary Eutectic System Solid Solubility.html">
            
                    
                    2.2.3 Ternary Eutectic System (No Solid Solubility)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="An-Or-Ab system.html">
            
                <a href="An-Or-Ab system.html">
            
                    
                    2.2.4 An-Or-Ab system
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" >
            
                <span>
            
                    
                    2.3 My computer program
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="Zircon REE reverse model.html">
            
                <a href="Zircon REE reverse model.html">
            
                    
                    2.3.1 Zircon REE reverse model
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.3.2" data-path="SortData and Quickplot.html">
            
                <a href="SortData and Quickplot.html">
            
                    
                    2.3.2 SortData and Quickplot
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Personal.html">
            
                <a href="Personal.html">
            
                    
                    3 Personal
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >2.3.2 SortData and Quickplot</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="sortdata-and-quickplot"><a name="sortdata-and-quickplot" class="plugin-anchor" href="#sortdata-and-quickplot"><i class="fa fa-link" aria-hidden="true"></i></a>SortData and Quickplot</h1>
<p>Geochemical researches often require a great amount of work of comparing data to those in literature. It is necessary and significant to find a quick way to create figures to show their geochemical variation. Because most scholars use Microsoft Excel<sup>&#xAE;</sup> to process data, I design a VB program which incorporates the most common geochemical discrimination figures, trace element spider diagrams, Haker diagrams and etc. While a great deal of software could do this job, my program has two unique advantages: (1) Quickly sort element sequence (2) Automatically Group data. These two functions could significantly increase work efficiency.</p>
<p>The following is a simple introduction to these two programs.</p>
<h2 id="sort-data"><a name="sort-data" class="plugin-anchor" href="#sort-data"><i class="fa fa-link" aria-hidden="true"></i></a>Sort data</h2>
<p>The sequence of the major and trace elements listed in tables is different from author to author, which cause much inconvenience when comparing data to each other. The quick VB program <a href="https://github.com/qiweizh/Qiweizh.github.io/blob/master/research/DataSort.xlam" target="_blank">SortData.xlam</a> is designed to solve this problem. For example, If we have two columns of sample data like CB15-1 and CB15-2 (Fig. 1), And we want the elements to be sorted as SiO<sub>2</sub>, TiO<sub>2</sub>, Al<sub>2</sub>O<sub>3</sub>, Fe<sub>2</sub>O<sub>3</sub>, FeO, MnO, MgO, CaO, Na<sub>2</sub>O, K<sub>2</sub>O, P<sub>2</sub>O<sub>5</sub>, Fe<sub>2</sub>O<sub>3</sub>T, FeOT, Li, Be, Sc, Ti, V, Cr, Mn, Co, Ni, Cu, Zn, Ga, Ge, As, F, B, Sn, Cs, Rb, Mo, Cd, Sr, Zr, Nb, Sb, Ba, W, Tl, Hf, Ta, Pb, Bi, Th, U, Y, La, Ce, Pr, Nd, Sm, Eu, Gd, Tb, Dy, Ho, Er, Tm, Yb, Lu, LOI. </p>
<p><img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_1.jpg?raw=true" width="400" height="900"></p>
<p><em>Fig. 1 The results of sorting</em></p>
<p>The first step open a new workbook and put the data needed to be sorted in &#x2018;Sheet1&#x2019; (Please note the first column is the name of elements). Next, press &#x201C;Alt+F11&#x201D; to open VBA project, select DataSort and press &#x201C;Run&#x201D; (Fig. 2a), and a window will come up as shown in Fig. 2b. Press &#x2018;Check element&#x2019; button. </p>
<p><img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_2.jpg?raw=true" width="300" height="250"></p>
<p><em>Fig. 2 (a) How to run SortData program (b) The interface of SortData</em></p>
<p>Then, it will check the element name column A in the &#x2018;Sheet1&#x2019;. If there is something wrong, for example, if &#x2018;Al2O3&#x2019; was mistakenly written as &#x2018;AL2O3&#x2019;, it will be highlighted with yellow shade (Fig. 3). You should correct it and run the program again. Please note that &#x2018;Al2O3&#x2019; does not need to be written as &#x2018;Al<sub>2</sub>O<sub>3</sub>&#x2019;. </p>
<p><img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_3.jpg?raw=true" width="300" height="300"></p>
<p><em>Fig. 3 Highlighting incorrect elements</em></p>
<p>After making sure the names of elements are all correct, click &#x2018;SortData&#x2019; button. The data will be sorted as we want (Fig. 1). You can see that the sequence of CaO and MgO has been changed and there are some Table cells like Ge, and As is blank because the original data do not have them.</p>
<h2 id="group-data-and-plot"><a name="group-data-and-plot" class="plugin-anchor" href="#group-data-and-plot"><i class="fa fa-link" aria-hidden="true"></i></a>Group data and plot</h2>
<p>Copy the sort data into a new workbook and open the <a href="https://github.com/qiweizh/Qiweizh.github.io/blob/master/research/Quickplot.xlam" target="_blank">Quickplot.xlam</a>. Change the content of table cell A1, B1, C1, D1 into &#x2018;Group name&#x2019;, &#x2018;Longitude and latitude&#x2019;, &#x2018;Age (Ma)&#x2019;, and &#x2018;Rock type&#x2019;, respectively. If you do not know the latter three, just leave them blank, but make sure you have names for each group. For example, I divide the data into four groups: &#x2018;OB&#x2019;, &#x2018;GB&#x2019;, &#x2018;HG&#x2019;, and &#x2018;GT&#x2019; by rock type. You just type the group name in the first column at the first appearance row of each group (Please see in Fig. 4). </p>
<p><img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_4.jpg?raw=true" width="700" height="600"></p>
<p><em>Fig. 4 The result of grouping data</em></p>
<p>Press &#x201C;Alt+F11&#x201D; to open VBA project and select &#x2018;Quickplot&#x2019; and run. A window will come up as shown in Fig. 5. Click &#x2018;Group&#x2019;. The data will be grouped quickly (Fig. 4). And then click &#x2018;Fe-calibration&#x2019; calibrate Fe<sub>2</sub>O<sub>3</sub> and FeO into FeOT. </p>
<p><img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_5.jpg?raw=true" width="700" height="230"></p>
<p><em>Fig. 5 The interface of SortData of Quickplot</em></p>
<p>And then, you could click all other buttons to get other plots like TAS, A-type granite discrimination, Haker diagram, S-type granite source region discrimination, zircon saturation thermometer (ZTS), and trace element spider diagram and ect. (Fig. 6). The most striking part is that data marker is automatically set up once you confirm the group names.  </p>
<p><img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_6a.jpg?raw=true" width="700" height="220">
<img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_6b.jpg?raw=true" width="700" height="250">
<img src="https://github.com/qiweizh/Qiweizh.github.io/blob/master/img/Fig.%203_6c.jpg?raw=true" width="700" height="300"></p>
<p><em>Fig. 6 Representative figures made by Quickplot</em></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Zircon REE reverse model.html" class="navigation navigation-prev " aria-label="Previous page: 2.3.1 Zircon REE reverse model">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Personal.html" class="navigation navigation-next " aria-label="Next page: 3 Personal">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"2.3.2 SortData and Quickplot","level":"1.2.3.2","depth":3,"next":{"title":"3 Personal","level":"1.3","depth":1,"path":"Personal.md","ref":"Personal.md","articles":[]},"previous":{"title":"2.3.1 Zircon REE reverse model","level":"1.2.3.1","depth":3,"path":"Zircon REE reverse model.md","ref":"Zircon REE reverse model.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["expandable-chapters","splitter","anchors","theme-comscore","livereload"],"pluginsConfig":{"livereload":{},"splitter":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"theme-comscore":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{},"expandable-chapters":{}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"SortData and Quickplot.md","mtime":"2019-04-01T02:52:47.757Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-04-01T07:04:05.790Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-theme-comscore/test.js"></script>
        
    

    </body>
</html>

